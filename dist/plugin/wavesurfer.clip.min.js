/*! wavesurfer.js 1.2.8 (Fri, 13 Jan 2017 03:05:29 GMT)
* https://github.com/katspaugh/wavesurfer.js
* @license CC-BY-3.0 */!function(a,b){"function"==typeof define&&define.amd?define(["wavesurfer"],function(a){return b(a)}):"object"==typeof module&&module.exports?module.exports=b(require("wavesurfer.js")):b(a.WaveSurfer)}(this,function(a){"use strict";a.Clip={init:function(b){var c=this;this.params=b;this.wavesurfer=b.wavesurfer;if(!this.wavesurfer)throw Error("No WaveSurfer instance provided");var d=this.drawer=this.wavesurfer.drawer;if(this.container="string"==typeof b.container?document.querySelector(b.container):b.container,!this.container)throw Error("No container for WaveSurfer clip");this.width=d.width,this.height=this.params.height||20;var e=this.container.querySelector("clip");if(e&&this.container.removeChild(e),this.params.template)this.container.innerHTML=this.params.template;else{var f=a.util.template("<div></div>");this.container.innerHTML=f}this.wavesurfer.on("region-update-end",function(){c.setRegionTable()}),this.wavesurfer.on("region-removed",function(){c.setRegionTable()}),this.segmentStart=document.querySelector("#waveform-clip-segment-start"),this.segmentEnd=document.querySelector("#waveform-clip-segment-end"),this.regionStart=document.querySelector("#waveform-clip-region-start"),this.regionEnd=document.querySelector("#waveform-clip-region-end"),this.clipReset=document.querySelector("#waveform-clip-reset"),this.clipReset.onclick=function(){c.wavesurfer.clearRegions(),c.init(b)},this.submit=document.querySelector("#waveform-clip-submit"),this.submit.onclick=function(){if(b.submit&&"function"==typeof b.submit){var a=c.wavesurfer.getDuration(),d=Object.keys(c.wavesurfer.regions.list).map(function(a,b){var d=c.wavesurfer.regions.list[a];return{start:d.start,end:d.end}}).sort(function(a,b){return a.start-b.start}),e=0,f=[];for(var g in d){var h=d[g];e<h.start?(f.push({start:e,end:h.start}),e=e<h.end?h.end:e):e=e<h.end?h.end:e}f.push({start:e,end:a}),b.submit(f)}},this.regionSubmit=document.querySelector("#waveform-clip-region-submit"),this.regionSubmit.onclick=function(){b.regionSubmit&&"function"==typeof b.regionSubmit&&b.regionSubmit(Object.keys(c.wavesurfer.regions.list).map(function(a,b){var d=c.wavesurfer.regions.list[a];return{start:d.start,end:d.end}}))}},setRegionTable:function(){var a=this,b=this.wavesurfer.regions.list;[].forEach.call(a.container.querySelectorAll("#region-list > tr"),function(a){var b=a.querySelectorAll("td");b[1].innerHTML="",b[2].innerHTML=""}),Object.keys(this.wavesurfer.regions.list).map(function(c,d){var e=b[c],f=a.container.querySelector("#region-list > tr:nth-child("+(d+1)+")");if(f){var g=f.querySelectorAll("td");g[1].innerHTML=a.formatTime(e.start),g[2].innerHTML=a.formatTime(e.end-e.start)}else f=document.createElement("tr"),a.container.querySelector("#region-list").appendChild(f),f.innerHTML="<td>"+(d+1)+"</td><td>"+a.formatTime(e.start)+"</td><td>"+a.formatTime(e.end-e.start)+"</td><td></td>"})},formatTime:function(a){return[Math.floor(a%3600/60),("00"+Math.floor(a%60)).slice(-2)].join(":")}},a.util.extend(a.Clip,a.Observer)});